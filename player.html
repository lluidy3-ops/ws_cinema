<!DOCTYPE html>
<html>

<head>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
        }
    </style>
</head>

<body>
    <div id="player"></div>
    <script>
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        var videoId = "";

        // Pega URL da Query String ?url=VIDEO_ID
        var params = new URLSearchParams(window.location.search);
        var urlParam = params.get('url');

        if (urlParam) {
            // Decodifica URL
            urlParam = decodeURIComponent(urlParam);

            // Se for link completo (youtube.com/watch?v=ID)
            if (urlParam.includes('v=')) {
                videoId = urlParam.split('v=')[1].split('&')[0];
            }
            // Se for link curto (youtu.be/ID)
            else if (urlParam.includes('youtu.be/')) {
                videoId = urlParam.split('youtu.be/')[1].split('?')[0];
            }
            // Se for s√≥ ID
            else {
                videoId = urlParam;
            }
        }

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: videoId,
                playerVars: {
                    'autoplay': 1,
                    'controls': 0,
                    'enablejsapi': 1,
                    'modestbranding': 1,
                    'rel': 0,
                    'showinfo': 0,
                    'iv_load_policy': 3
                },
                events: {
                    'onReady': onPlayerReady
                }
            });
        }

        function onPlayerReady(event) {
            event.target.playVideo();
            event.target.setVolume(100);

            // Ouvinte para mensagens do Client.lua
            window.addEventListener('message', function (event) {
                var data = event.data;
                // Se vier como string JSON
                if (typeof data === 'string') {
                    try { data = JSON.parse(data); } catch (e) { }
                }

                if (data.func == "pauseVideo") player.pauseVideo();
                if (data.func == "playVideo") player.playVideo();
                if (data.func == "stopVideo") player.stopVideo();
                if (data.func == "seek") player.seekTo(data.args);
            });
        }
    </script>
</body>

</html>